{% extends "base.html" %} {% block content %}
<section class="min-h-[70vh] flex items-center justify-center px-6">
  <div class="relative max-w-3xl w-full text-center">
    <!-- Glass Card -->
    <div
      class="bg-black/40 backdrop-blur-xl border border-white/10 rounded-3xl p-10 shadow-2xl">
      <!-- Icon -->
      <div class="mb-6">
        <i
          class="fa-solid fa-hourglass-start text-5xl text-cyan-400 animate-pulse"></i>
      </div>

      <h2
        class="text-3xl md:text-4xl font-extrabold tracking-widest bg-gradient-to-r from-purple-400 to-green-400 bg-clip-text text-transparent mb-4">
        COMPETITION STARTS IN
      </h2>

      <!-- Countdown Timer -->
      <div id="countdown" class="flex justify-center gap-6 text-center my-10">
        <div
          class="bg-white/5 border border-white/10 rounded-2xl px-6 py-4 min-w-[90px]">
          <div id="hours" class="text-4xl font-bold text-green-400">00</div>
          <div class="text-xs text-gray-400 mt-1">HOURS</div>
        </div>
        <div
          class="bg-white/5 border border-white/10 rounded-2xl px-6 py-4 min-w-[90px]">
          <div id="minutes" class="text-4xl font-bold text-cyan-400">00</div>
          <div class="text-xs text-gray-400 mt-1">MINUTES</div>
        </div>
        <div
          class="bg-white/5 border border-white/10 rounded-2xl px-6 py-4 min-w-[90px]">
          <div id="seconds" class="text-4xl font-bold text-purple-400">00</div>
          <div class="text-xs text-gray-400 mt-1">SECONDS</div>
        </div>
      </div>

      <!-- Start Time Info -->
      <p class="text-gray-300">
        Scheduled Start Time:
        <span class="font-semibold text-white">
          {{ test.start_time|date:"d M Y, h:i A" }}
        </span>
      </p>

      <p class="text-sm text-gray-400">
        <i class="fa-solid fa-circle-info"></i>
        Please wait here. Do not refresh or leave this page.
      </p>

      <!-- Loading Bar -->
      <div class="mt-8 w-full h-2 bg-white/10 rounded-full overflow-hidden">
        <div
          class="h-full bg-gradient-to-r from-purple-500 to-green-400 animate-pulse"></div>
      </div>
    </div>
  </div>
</section>

<script>
  const startTime = new Date("{{ test.start_time|date:'c' }}");

  const hoursEl = document.getElementById("hours");
  const minutesEl = document.getElementById("minutes");
  const secondsEl = document.getElementById("seconds");

  function updateCountdown() {
    const now = new Date().getTime();
    const diff = startTime.getTime() - now;

    if (diff <= 0) {
      window.location.href = "{% url 'take_test' test.id %}";
      return;
    }

    const hours = Math.floor(diff / (1000 * 60 * 60));
    const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
    const seconds = Math.floor((diff % (1000 * 60)) / 1000);

    hoursEl.innerText = String(hours).padStart(2, "0");
    minutesEl.innerText = String(minutes).padStart(2, "0");
    secondsEl.innerText = String(seconds).padStart(2, "0");
  }

  updateCountdown();
  setInterval(updateCountdown, 1000);
</script>

{% endblock %}
