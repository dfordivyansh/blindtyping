{% extends "base.html" %}

{% block content %}
<section class="max-w-7xl mx-auto px-6 py-16">

  <!-- Title -->
  <div class="mb-12 text-center">
    <h2 class="text-5xl font-extrabold tracking-widest bg-gradient-to-r from-cyan-400 to-green-400 bg-clip-text text-transparent mb-3">
      LEADERBOARD
    </h2>
    <p class="text-gray-400 text-lg">
      Top performers of the Blind Typing Challenge
    </p>
  </div>

  {% if results %}
  <!-- ===== Top 3 Podium ===== -->
  <div class="grid md:grid-cols-3 gap-6 mb-14">

    {% for r in results|slice:":3" %}
    <div class="relative bg-black/50 backdrop-blur border border-white/10 rounded-2xl p-6 text-center shadow-xl
                {% if forloop.counter == 1 %} ring-2 ring-yellow-400 {% elif forloop.counter == 2 %} ring-2 ring-gray-300 {% elif forloop.counter == 3 %} ring-2 ring-orange-400 {% endif %}">
      
      <!-- Medal Icon -->
      <div class="absolute -top-4 left-1/2 -translate-x-1/2 text-3xl">
        {% if forloop.counter == 1 %}
          <i class="fa-solid fa-trophy text-yellow-400"></i>
        {% elif forloop.counter == 2 %}
          <i class="fa-solid fa-medal text-gray-300"></i>
        {% elif forloop.counter == 3 %}
          <i class="fa-solid fa-medal text-orange-400"></i>
        {% endif %}
      </div>

      <!-- Avatar -->
      <div class="mx-auto mb-4 h-16 w-16 rounded-full bg-gradient-to-r from-purple-500 to-green-400 flex items-center justify-center text-black text-2xl font-bold">
        {{ r.user.username|first|upper }}
      </div>

      <h3 class="text-xl font-bold text-white mb-1">
        {{ r.user.username }}
      </h3>

      <p class="text-sm text-gray-400 mb-4">Rank #{{ forloop.counter }}</p>

      <div class="flex justify-around text-sm">
        <div>
          <div class="text-lg font-bold text-green-400">
            <i class="fa-solid fa-gauge-high mr-1"></i> {{ r.wpm }}
          </div>
          <div class="text-gray-400">WPM</div>
        </div>
        <div>
          <div class="text-lg font-bold text-cyan-400">
            <i class="fa-solid fa-bullseye mr-1"></i> {{ r.accuracy|floatformat:2 }}%
          </div>
          <div class="text-gray-400">Accuracy</div>
        </div>
      </div>
    </div>
    {% endfor %}

  </div>
  {% endif %}

  <!-- ===== Full Table ===== -->
  <div class="overflow-x-auto rounded-2xl border border-white/10 bg-black/40 backdrop-blur shadow-2xl">

    <table class="w-full text-left">
      <thead class="bg-gradient-to-r from-cyan-500/20 to-green-500/20 text-cyan-300 sticky top-0">
        <tr>
          <th class="px-6 py-4 font-semibold">Rank</th>
          <th class="px-6 py-4 font-semibold">User</th>
          <th class="px-6 py-4 font-semibold">WPM</th>
          <th class="px-6 py-4 font-semibold">Accuracy</th>
        </tr>
      </thead>

      <tbody class="divide-y divide-white/10">
        {% for r in results %}
        <tr class="hover:bg-white/5 transition">

          <!-- Rank -->
          <td class="px-6 py-4 font-bold">
            {% if forloop.counter == 1 %}
              <span class="text-yellow-400">
                <i class="fa-solid fa-trophy mr-1"></i> 1
              </span>
            {% elif forloop.counter == 2 %}
              <span class="text-gray-300">
                <i class="fa-solid fa-medal mr-1"></i> 2
              </span>
            {% elif forloop.counter == 3 %}
              <span class="text-orange-400">
                <i class="fa-solid fa-medal mr-1"></i> 3
              </span>
            {% else %}
              <span class="text-cyan-400">
                <i class="fa-solid fa-hashtag mr-1"></i>{{ forloop.counter }}
              </span>
            {% endif %}
          </td>

          <!-- User -->
          <td class="px-6 py-4 flex items-center gap-3">
            <div class="h-10 w-10 rounded-full bg-gradient-to-r from-purple-500 to-green-400 flex items-center justify-center text-black font-bold">
              {{ r.user.username|first|upper }}
            </div>
            <span class="font-semibold text-white">{{ r.user.username }}</span>
          </td>

          <!-- WPM -->
          <td class="px-6 py-4 font-semibold text-green-400">
            <i class="fa-solid fa-gauge-high mr-1"></i> {{ r.wpm }}
          </td>

          <!-- Accuracy -->
          <td class="px-6 py-4 text-cyan-400">
            <i class="fa-solid fa-bullseye mr-1"></i> {{ r.accuracy|floatformat:2 }}%
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="4" class="px-6 py-12 text-center text-gray-400">
            <i class="fa-solid fa-rocket mr-2"></i>
            No results available yet. Be the first to compete!
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

</section>
{% endblock %}
